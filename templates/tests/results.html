{% extends 'base.html' %}
{% load static %}

{% block content %}

<section id="hero1" class="d-flex align-items-center">
    <div class="container position-relative" data-aos="fade-up" data-aos-delay="100">
        <br>
        <br>
        <br>
        <div class="row justify-content-center">
            <div class="col-xl-12 col-lg-12 text-center">
                <h2>Категория - {{ data.category.category_name }}</h2>
                <br>
                <h1>Тест "{{ data.test.test_name }}"</h1>

                <div class="text-center">
                    <a href="{% url 'test_description' category_slug test_slug %}" class="btn-get-started scrollto">&#8634; Пройти тест еще раз</a>
                </div>
                <br>
                <br>
                <h2>Ваши результаты:</h2>
                <br>

                {% if is_big5 %}
                <div class="big5-results mt-5">
                    <h3>Անհատականության Պրոֆիլ</h3>
                    
                    {% for trait_code, trait_data in interpretation.items %}
                    <div class="trait-card mb-4 p-3 border rounded">
                        <h4>{{ trait_data.name }} - {{ trait_data.score|floatformat:1 }}%</h4>
                        <div class="--progress mb-2">
                            <div class="progress-bar" role="progressbar" 
                                style="--progress-width: {{ trait_data.score|floatformat:'0'|default:0 }}%; width: var(--progress-width);"
                                aria-valuenow="{{ trait_data.score|floatformat:'0'|default:0 }}" 
                                aria-valuemin="0" 
                                aria-valuemax="100">
                            </div> 
                        </div>
                        <div class="trait-description">
                            {{ trait_data.description|safe }}
                        </div>
                    </div>
                    {% endfor %}
                    <div class="general-description card mt-4">
                        <div class="card-body">
                            <h4 class="card-title">Ընդհանուր Բնութագիր</h4>
                            {% for desc in general_description.values %}
                            <div class="card-text">
                                {{ desc|safe }}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="regular-results">
                    <h2>&#9989; Правильных ответов: {{ data.correct_answer_count }}/{{ test_question_amount }}</h2>
                    <h2>&#10060; Неправильных ответов: {{ data.wrong_answer_count }}/{{ test_question_amount }}</h2>
                    <h2>Процент правильных ответов: {{ data.correct_answer_percent }}</h2>
            
                </div>
                {% endif %}
                <br>
                <br>
                <br>
                <div>
                    <a href="{% url 'tests' %}" class="btn btn-outline-primary"><i class="bi bi-arrow-left">
                    </i> К тестам!</a>
                </div>
            </div>
        </div>

    </div>
</section>

<script>
$(function() {
if (window.history && window.history.pushState) {
$(window).on('popstate', function () {
window.history.pushState('forward', null, '#');
window.history.forward(1);
});
}
 window.history.pushState ('forward', null, '#');
window.history.forward(1);
})

</script>

{% endblock %}